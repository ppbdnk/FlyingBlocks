# FlyingBlocks
 
桌面卫星模拟系统下位机软件套件

---

主要内容：
     
    1.FB_Main 主控板
    2.FB_Power 电源板
    3.FB_Thermal 热控板
    4.FB_Attitude 姿控板
    5.Resources 数据帧格式
    6.SCH 电路原理图
    7.libraries 库文件
    
---    
### 电源板
  
功能描述

    （1）放置电池电源接口、太阳能电池板接口及充电接口，通过光耦继电器控制桌面卫星系统的八路电源开闭，决定电源的供给。
    （2）实现电池低电量报警功能，在电池电量低时，对应报警LED灯亮红灯。
    （3）获取电池电量数据，并将其发送给主控板。
    
工作流程

        学生首先连接电源板上的跳线座，为每个模块选择电源。之后再上位机上选择开启对应电源。然后学生接通卫星总电源，打开
    桌面卫星系统开关，12V电源经过电源板上的LM7805降压为5V，驱动电源板，电源板开始工作。电源板开始工作之后，控制全部8
    个光耦继电器全部连通。之后卫星全部模块通电，12V电压进入各个子系统后     由各个子系统上的LM7805降压为5V供各个子系
    统使用，这时主控板开始时工作，随后与上位机接通，获取上位机发送而来的指令，主控板将指令转发给电源板，电源板关闭不需
    要的继电器，系统电源开始进入稳定工作状态。然后电源板开始稳定运行，循环读取电池电量，发送给主控板，并由主控板转发给
    上位机。学生连接的电源板上的跳线座需要与上位机上选择的电源选项对应，否则桌面卫星系统不能正确启动。
    
---    
### 热控板

功能描述

    （1）读取桌面卫星系统上所有温度传感器的数据，并将其发送给主控板，再由主控板发送给上位机做显示。
    （2）根据上位机发送的温度设定值，通过板上的光耦继电器控制加热电阻的开闭，以控制桌面卫星系统的温度。
    
工作流程

        启动系统前，学生连接热控板上加热电阻的跳线帽。系统启动后，首先，主控板将从上位机获取的目标温度值发送给热控板。
    热控板进入循环，根据目标温度值调节卫星系统中的加热电阻的开闭，实现对温度的调节。同时，稳定运行时，热控板获取卫星其
    它各个子系统的温度传感器数据，并发送给主控板，主控板将温度数据发送给上位机做显示。（所有温度传感器都接在热控版上，
    热控板轮循一次耗时会比较长，可能温度控制偏差会比较大）

---
### 姿控板

功能描述

    （1）控制卫星飞轮的开闭，同时调节飞轮旋转的方向和转速，以调节桌面卫星系统的姿态。
    （2）通过红外光电传感器实现对飞轮转速的测量，并将测得的转速发送给主控板，再由主控板发送给上位机。
    （3）控制磁力矩棒的开闭。
    （4）通过I2C读取九轴传感器的姿态数据，并发送给主控板，再由主控板发送给上位机显示。
    （5）读取姿态敏感器板上光敏电阻的数据，实现太阳敏感器的功能。

工作流程

        姿控板通电后，飞轮和磁力矩棒默认都处于关闭状态，学生通过上位机向姿控板发送指令，开启或关闭飞轮和磁力矩棒，
    同时控制飞轮转速和方向。飞轮打开时，姿控板通过测速装置实现对飞轮转速的测量。同时姿控板与姿态敏感器板连接，读取
    姿态敏感器板上九轴传感器的数据，将来也可以读取太阳敏感器的数据。姿控板将这些数据发送给主控板，再由主控板转发给
    上位机。姿控板稳定运行时，不间断读取九轴传感的姿态数据，发送给主控板，并由主控板发送给上位机。

---
### 主控板

功能描述

    （1）向热控板、姿控板、电源板请求卫星数据，将获取的各种数据通过Zigbee发送给上位机做显示。
    （2）通过Zigbee接收上位机发送来的温度控制、电源控制、飞轮控制、磁力矩棒控制指令，并将指令分别转发给对应子系统。
    （3）由主控板上的433M无线串口模块，实现桌面卫星系统间的通信，并通过主控板上的LED灯来展示通信结果。

工作流程

        主控板通电后首先通过Zigbee建立与上位机的连接，然后接收上位机发送的电源控制、温度设定的初始配置，发送给相应
    子系统。待系统稳定运行后，可从上位机获取飞轮开闭及旋转控制、磁力矩棒开闭、温度设定、电源控制等指令，接收到指令后
    再将其转发给对应子系统。同时稳定运行时，不断循环向上位机发送电池电量、温度、九轴传感器数据等信息。此外，还可以通
    过在主控板上的433M无线串口模块，实现桌面卫星系统之间的通信，以控制主控板上LED灯的亮灭。

    
